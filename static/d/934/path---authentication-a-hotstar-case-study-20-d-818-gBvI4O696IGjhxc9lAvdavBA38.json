{"data":{"site":{"siteMetadata":{"title":"undefined is not a function","author":"Pranshu Chittora"}},"markdownRemark":{"id":"d251129d-cde5-5afa-bd82-e22eca101336","excerpt":"Hotstar is an Indian streaming service owned by Star India, which itself is a wholly owned subsidiary of The Walt Disney Company. Over the…","html":"<p>Hotstar is an Indian streaming service owned by Star India, which itself is a wholly owned subsidiary of The Walt Disney Company. Over the past few years, it gained a lot of eyeballs due to recent internet revolution in India, which made the internet easily accessible and affordable.</p>\n<p>This year Hotstar became one and only online streaming service for IPL (Indian Premier League) and GOT (Game of Thrones S8), which are accessible online via the subscriptions pack on Hotstar only. On the contrary, it’s a little bit early in India to adopt subscription-based services.</p>\n<p>It was March of 2019, one of the crucial time for Hotstar as IPL was about to start and GOT too. Unfortunately, somehow user credentials got leaked on a wide basis. Which includes user’s email and password in plain text along with the details of their subscription plan and expiration date. And these details were floating all over the internet in the form of Throwbin links and all other possible ways.</p>\n<p>This security breach made accessing premium content for free. As soon as they(Hotstar) came to know about this situation they reacted back by adding one more step to their authentication process in order to prevent alien access by enabling 2FA (OPT). This took them about a month to get this feature into production.</p>\n<h4>Is it a marketing strategy</h4>\n<p>In early 90s Microsoft knowingly allowed piracy of Microsoft Windows in developing countries like China, and this emerged as one of the successful strategy ever adopted by Microsoft.</p>\n<div>\n          <div\n            class=\"gatsby-resp-iframe-wrapper\"\n            style=\"padding-bottom: 56.25%; position: relative; height: 0; overflow: hidden;margin-bottom: 1.0725rem\"\n          >\n            <iframe src=\"https://www.youtube.com/embed/fGIrnT5yPWo\" frameborder=\"0\" allow=\"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen style=\"\n            position: absolute;\n            top: 0;\n            left: 0;\n            width: 100%;\n            height: 100%;\n          \"></iframe>\n          </div>\n          </div>\n<p>Similarly, Hotstar is letting other people use their service in an odd way to convert users. This is just my speculation.</p>\n<p>Let’s get back to the Login system of Hotstar</p>\n<p>\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/a6a177c40c648641e411a2a0503b19dd/994e4/otp.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 596px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 96.64429530201342%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAAAsSAAALEgHS3X78AAADxklEQVQ4y42U60+TZxjG3z/AzUUGYxMLQjm1HEpbsBxWhRZsxQLKUWZHOWzRqbgJM1mWsS9m+6Qytw9bMreYnU0GQ5YMEMm2+MklfHIkQEAtpaVQwlHatcBvb19aY5Yp3smV58mT+71yXc99Pa+gUejJVhahSyshO1lEopmcxFJp3Q45SYcoyCinSFuFMbuaIk0VgixCSWK0FtlOFe+1fsTQwG1+7R5koPdP+nv/eCL6bvzOrd9uc+PnPqrMNmrKmqiraEbIzTKgSTlAzHOZ/Hith63a4FlryukiJb+YZLUBhaYYIU9tJC+zhKgdsVz94qrU5P/HTyAQELH+v1gX4fcHpN7xsXsoE4tRxhtRyI0IsdFyYqOVxEcl0HP9e6lpc3NzW2UbG1suHHYn+9OPoIkzkZtkQchX56BSZJCwJ4Xu6z9t2ZhyMOt2Mzc3x5TDgXvWjcvlwi2eBeH1+R4Ru5wzmF89Rl15CxUlryOoU1UY9uWSlJRKV3ePaCfAyMgITqeT8fFxhoeHWX34EO/aGmsifCLZ+vr6Ixf2+w5K9fUiYTOmvFqEBFkKxnw9loOldHX9IjX5QgqC9xgkeprl6SknlYdsojorhwvrERRyFRVmC/VVddzsH9giCl14uIJqggiSPL6XLE/PUFHYgFFbQ625BUGlyKbcXE51eSW9Pb1S0+zyNMu+BVZ9K9KHQYvh9b+E9x88IK/IgE5vJKegECEjWYvFaCY3R8+XX30nNblX7Mx73az4F7ed9oR9AsVhJUqTilSTQiSUZ5Cu0PJ8hJyvr/0gNS3ML7GytMrS4jILCwssLi5KCO7D8Hjm8Qf83Juwo5GbyNpbglpchfR4BTEvy8lK0zLY1y8G1s/dv+8yOjbK6OgoY2NjTE5OSghOPXwWTIJnfo7JcTvKaCOpkUUoogwIJkMZlZajWGuPMTR4S1IYjsfT4PV6Q8Ge5qipgYpiK0eCOez4sINLnZ1c+PgCd/6688wvJVwej4eLly/SeeUynZ9cEgk/6KD9dCvHK5u52TcUyt/WVB+PyZNi455xca71JLW1ddhsNoS2tjZK1GbiInR8+0339pJC6jc21kNPzyE+iv3I9sSgSk0Rh6JSkRkr/nHSLdhqznDK+j4nXjtPvbWRlhMn6Xj3PI22Js6+c472xkY+f+sUn775BlfePstnp8/Qbj2O8UABdWVmGkxmhJ0Ru0jbrReTXo0pvwZtwkESdunY8UIkEa/I0GWp2S3by0txchSRL9KUnoZNFGEryKclT0dhYjxGkwl1RhZG1T7+BVjNZHCLgyZMAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"OTP while logging in to Hotstar\"\n        title=\"\"\n        src=\"/static/a6a177c40c648641e411a2a0503b19dd/994e4/otp.png\"\n        srcset=\"/static/a6a177c40c648641e411a2a0503b19dd/8a346/otp.png 250w,\n/static/a6a177c40c648641e411a2a0503b19dd/cf6bd/otp.png 500w,\n/static/a6a177c40c648641e411a2a0503b19dd/994e4/otp.png 596w\"\n        sizes=\"(max-width: 596px) 100vw, 596px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>Unfortunately, I found a way to bypass this 2FA and login to an account by just using <code class=\"language-text\">email</code> and <code class=\"language-text\">password</code>.</p>\n<blockquote>\n<p><strong>Disclaimer</strong> =>\nI am not encouraging anyone to login to others account. This is just for demonstration and learning purposes.</p>\n</blockquote>\n<h4>Understanding the user types</h4>\n<p>Hotstar has two types of registered users, i.e. <code class=\"language-text\">phone</code> and <code class=\"language-text\">merged</code>. In simple terms, a user of type <code class=\"language-text\">phone</code> is one who has linked his account to his mobile number and <code class=\"language-text\">merged</code> is one who has only email linked.</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"description\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token property\">\"exists\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span> <span class=\"token property\">\"usertype\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"phone\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"message\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Success\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"appCode\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"UMSP_701\"</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"description\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token property\">\"exists\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span> <span class=\"token property\">\"usertype\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"merged\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"message\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Success\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"appCode\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"UMSP_701\"</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h4>The Login Flow</h4>\n<p>A user can log in via various methods, but today we will focus on logging in with email.</p>\n<p>\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/0fb7a352c4bfa7044553777e61726fd5/39751/login-form.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 373px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 127.07774798927613%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAZCAYAAAAxFw7TAAAACXBIWXMAAXcAAAF3AAHmAuEvAAAC1klEQVQ4y6VVSW/TUBD2f+DApSwSQnDiwg2BhFTEgQKqoBI9caEIwZkLPwdEyyKWpk0r2pRuiO6AEBdO0GzYjuMkdpbaz37+mHlp06hZCOqTvsz2Zt6M35uJhkOuKIoUFUKgVqtBY0UvaHbuFJSX1k55kO8WsNnG0KSUYPAKw7DBMw2CoO0hXQNy7d++bGF8PIbFpWXiN7GxsYmpqThmEwlMT09DN8yWbDst9Q1930OhUITn+ZSVINkn3lOUPzRn3us31Q5zu+0OUQFd11XZCcqI+SplVa1WVXblclnpaiRXCI7jUOai4yGq5HLFxY5XUyg5RThlByW3pPQlt6h0Lukc10GhVEBtp4pQBghC0QDLhyq5Y4YyCrGZncfSdgyfkpNY3t7H0vYE5n+9bWDh93vSTygb760jjkXSfzc+1zP0wx2MxC7i6rOjuDF2AgOjx3CdcO15HwZfnMI9so3ELuE+4e6782Q73tjDlH36nx7B45nB/YCP4ldwc+wkhl6fxdCrMwq3Xp7G8JtzeBjvx4PJy2rPSOwCbpOtGewzMNqHJ3N36gFlJPHDXMNG5qPCWjKB9VRC8avJWaykPmA1PYOVJNHUDNnm6vZ0ff9WdgHrmQR+Wl9bL8Ur+9DTOZQsF2bGQjZpwNYLKORcWFkbeeJtowjbLMGr0HRxPerRNs+GLyZk8FPYfQ5WPgfD1JFOJ6n1dOjEmzmDdAbydp72BGq/AvlyjI7TZk+Wkg+pDwxuv73hsdeKHcfXwYnxj/7vOtq09hOkl4EbtQ2udWv2/0GjZElCpRZSf0qIgEaZkNT8UlElN/GCqdiVm/gq+TNUwCCMaChIRDJCRvdgFQSKTqCokfNhFwXyu7xhMQTpAuTyAiYhZ9cnDwdUJXNAzk5SwFTWg06OFm1iygewA8vpPx5ShKzhw6SgbGMdB+WKGwH5p9qpZNF7yezf0int3mLLpSHq+v/yF9RMWAEmw8ibAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"Login Form\"\n        title=\"\"\n        src=\"/static/0fb7a352c4bfa7044553777e61726fd5/39751/login-form.png\"\n        srcset=\"/static/0fb7a352c4bfa7044553777e61726fd5/ac93d/login-form.png 250w,\n/static/0fb7a352c4bfa7044553777e61726fd5/39751/login-form.png 373w\"\n        sizes=\"(max-width: 373px) 100vw, 373px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>Both the type of users i.e. <code class=\"language-text\">phone</code> and <code class=\"language-text\">merged</code> can log in to their account by using the linked <code class=\"language-text\">email</code>.</p>\n<p>\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/d28efa1b1df0f0ca40e0adc0cc242c7b/eb2e1/email-form.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 385px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 119.48051948051948%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAYCAYAAAD6S912AAAACXBIWXMAAAsSAAALEgHS3X78AAAC20lEQVQ4y7WVy08TURTG+4+4cOUClZi4ENGQCAsjVht5CmkAUxPFSAiwcOPCuHJjjAYJCgsRTSBKqFoSTTRCoWX6oC19IIryKKXzaGkp005bOnzeGcG2Cg0o3OSXc+6553455955KECGsBZDIhWXXKyvr8vsdGzmiqIIMSVCIU28kXksC4H/EowLcQiCAEXm5t0IbSUqDUVmVVI87efmz242/W0rzCWUmZtTcKftSRew3RHJLc/MzMBgMICiKJjNZjgcDphMJrjdbrhcLng8Hjlmt9vlOMdxuQVTqRSSySQSiYSMNJesFEuuJSHEBcRiMfA8L99kruOQBUOhEBa9i5ibnYN3wQvfok+2HMPJcX41uuPjkAW5MIspL2lv1gnPvBtfvFPEuvDVN018DxaC8+BiDBielmGj2TC8H+F46FeF//rs5azQ6qfQbr2PbvtjPLW3Z9Fpe0h4JNsnxHaRWBfJ26Tb0YGOiQf48GMofYbShryuAzjVm4+CnsMyJwgne46g5o0K6rdlqNdVQvW6BIXPj5K1vN950jy/+yBaPzamBfumelHaX4TL2guoHCzNokFXJaMZqkHdu3JUDZ7PWq/WKqF8dQb3jHfSgtFkDBzPIRAN/AXDM6BXafgjfrA8C26LHJbsjcQj+3gpPjoOo20F5skVjNvC+EwFYZxYhsEahN4cwKiFYOagN7EYMTEYpmiCn8RokiP5S/B8W063/ELLoVjthFLjRG2zG/06GnWtk6hotEJzy476NivqWsyouTkOdbMR9S0G1DbpUVz9HqfLdDh2dgBtd41pwWcDDAorHChRO3Dp+iQ6X3pR3mjDuQYTqm5YUHaNwkWNAcoremJHoLo6DGXDJxSodDheqsWhoj403R5NCy6xCdJuBDb3KizOFYxZQ2Qehskekls3TgQ3CJAWOYxZWBnKxpIcFgYLjenv+/mmiMRJpQjiht015AclZnxt9nLsueBP8QTRdd/+r/QAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"Email Login Form\"\n        title=\"\"\n        src=\"/static/d28efa1b1df0f0ca40e0adc0cc242c7b/eb2e1/email-form.png\"\n        srcset=\"/static/d28efa1b1df0f0ca40e0adc0cc242c7b/bd167/email-form.png 250w,\n/static/d28efa1b1df0f0ca40e0adc0cc242c7b/eb2e1/email-form.png 385w\"\n        sizes=\"(max-width: 385px) 100vw, 385px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>If the email entered belongs to a userType <code class=\"language-text\">phone</code>, then that user is asked to enter the OTP (as shown below). Followed by a password prompt.</p>\n<p>\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/65c0615518fb708aa9984a68092ba24c/28498/opt-form.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 384px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 118.75%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAYCAYAAAD6S912AAAACXBIWXMAAXcAAAF3AAHmAuEvAAABpklEQVQ4y81UiXKCMBTk/z/OacUDtQaw1mo9uCpgQtjmxUFBkWJtZ5qZnYSXvHXfpQG1vOQDqUjoiDzPNdqu4i3nXMOgj2XkIEz9hwnTNIVRdr6HqI6UllYoc3kyFgrboExW2IyfqroVkVZIsVMOpMz0nmXZyUZnciz28rku55rwffEG0+xh5rpgzIaj9tf5HGbPhGWNMJ1O0el09G72+hgOh5jNZhBC1Odwu91gZFmayLZtMJthPJ6g+/yEzdY7KScCzoVWeKmyQrhThI5jY+f5CMMAvudhoFT0zC78ILorj62K0rbSFUJ+4JWHUkqNW793S4gBZVeuCD8DiExcVfFMnFfOzW3DE6RZDCG5dqDkHw6HI0qtQ/a6limHrwlXqyUG/aEqjKvagSrN4KqKv0xfEEbRlZqmfD40KXV51QqTJIHvU8uECIKgArIXuLwrY7/fl0Ne6e6fTCaqocdnqG9qdMdxdAoYY9dvFCw1FHM1WSfC9XqtH5IDjVcZRHbEcYou7wnku1gszoQ0VhR2E+I4brynjvi7otzzp/rdGBr45fX/Cb8ApnxUsDlbjPwAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"Email Login Form\"\n        title=\"\"\n        src=\"/static/65c0615518fb708aa9984a68092ba24c/28498/opt-form.png\"\n        srcset=\"/static/65c0615518fb708aa9984a68092ba24c/4ada6/opt-form.png 250w,\n/static/65c0615518fb708aa9984a68092ba24c/28498/opt-form.png 384w\"\n        sizes=\"(max-width: 384px) 100vw, 384px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>If a userType of <code class=\"language-text\">merged</code> who can login to his account, by using the password only. If that email is filled in the login form. Then you are asked to type the password (as shown below).</p>\n<p>\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/52f0179794e871c7ae16c99ddd8404f1/03815/no-phone-login.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 387px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 124.03100775193798%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAZCAYAAAAxFw7TAAAACXBIWXMAAXcAAAF3AAHmAuEvAAABtElEQVQ4y7VTaW+CQBDl//+pGr9WGxOb1NgoiwdegJQbOV53RkGw4NHaIS+B3dnHzrw3CmQc0gixBEWe54x7o8jNsoyh0MfGm2Hr6X8ijKIIYRhCqR5+hKiJlEKp3orWz+957bbXbl4nbCBoI7xGVuQq95R5i7QaXLJQJ3jpdDAYDNDrvWI4fMdbv49utwtViFLFe8pnwiRJWKFIIgwDVozg+z4TXSvxsjVM6HseFosFVqsVdJ2gYz6bQWgavy+XS+gSe9u+2U8mDPwj4WazYcL1eo3FfA4hNP4JrRNc1z2V3y6e8qj3iom4RK3k8i/84KaFmkrNjyY+9VCWvNvtuEf7vQXLIuwRx3GrAAV5mqawTBOO4xY3lJtSyDw9Ik0yHA4HVp6S20qsosgrSw4TD2awhhVu4cZf+G2UKjuRBWF9QLM/YYfGaTO7OZJPUfmuGwZBIEXZwjANhimbXMAwjBqqe9Ucx3HOPaTF0WiE8Xj8A6oqoMmJIZMLoTbm0FkajJLQlnaZTCbygJAEag1EVsXlPp2ZTqc8XSUhSU42aQJZqIq2PLLO/4nyqD2u2gZPjqcTfgPl1qWAufghPQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"Email Login Form\"\n        title=\"\"\n        src=\"/static/52f0179794e871c7ae16c99ddd8404f1/03815/no-phone-login.png\"\n        srcset=\"/static/52f0179794e871c7ae16c99ddd8404f1/0725b/no-phone-login.png 250w,\n/static/52f0179794e871c7ae16c99ddd8404f1/03815/no-phone-login.png 387w\"\n        sizes=\"(max-width: 387px) 100vw, 387px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>Now here comes the interesting part. If you erase the email field and enter an email which is linked to an account of type <code class=\"language-text\">phone</code>, and enter the correct password and hit continue.\n<strong>Voila you are now successfully logged in and bypassed the OTP verification🎉</strong></p>\n<p>Heres the response from the server.</p>\n<blockquote>\n<p>userType = <code class=\"language-text\">merged</code></p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"description\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"userIdentity\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ7XCJoSWRcIjpcImFjbnxyYW1lc2hhZGRzQGdtYWlsLmNvbVwiLFwicElkXCI6XCJyYW1lc2hhZGRzQGdtYWlsLmNvbVwiLFwibmFtZVwiOlwiUmFtZXNoIEFkZHUgQWRkdSBBZGR1XCIsXCJlbWFpbFwiOlwicmFtZXNoYWRkc0BnbWFpbC5jb21cIixcImV4dEF1dGhJZFwiOlwiMTAxNTcyMTYyNDg1ODI1NzVcIixcImlwXCI6XCIxMDYuMjA4LjEzMi41XCIsXCJjb3VudHJ5Q29kZVwiOlwiaW5cIixcImN1c3RvbWVyVHlwZVwiOlwibnVcIixcInR5cGVcIjpcIm1lcmdlZFwiLFwiaXNFbWFpbFZlcmlmaWVkXCI6ZmFsc2UsXCJpc1Bob25lVmVyaWZpZWRcIjpmYWxzZSxcImRldmljZUlkXCI6XCIwOWMxZmU1NS05ZDNmLTRlNTQtOGQ1OS02NTBlZGNlMjMzZTlcIixcInZlcnNpb25cIjpcInYyXCIsXCJzdWJzY3JpcHRpb25zXCI6e1wiaW5cIjp7XCJTcG9ydHNQYWNrXCI6e1wic2hvd0Fkc1wiOlwiMVwiLFwiZXhwaXJ5XCI6XCIyMDE5LTExLTAzVDE0OjQ5OjQzLjAwMFpcIixcInN0YXR1c1wiOlwiQ1wifX19LFwiaXNzdWVkQXRcIjoxNTYyNDkxMjgyNTQ4fSIsImlzcyI6IlVNIiwiZXhwIjoxNTYyNTc3NjgyfQ.Qh3bxDH5mAlAGTQMnm0wbTdxUhUmEV_e3zMZwu0YSL8\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"message\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Login Success\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"appCode\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"UMSP_700\"</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<blockquote>\n<p>userType = <code class=\"language-text\">phone</code></p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"description\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"userIdentity\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ7XCJoSWRcIjpcImFjbnxwcml5YWhvdHN0dWZmQGdtYWlsLmNvbVwiLFwicElkXCI6XCJwcml5YWhvdHN0dWZmQGdtYWlsLmNvbVwiLFwibmFtZVwiOlwiUHJpeWFua2EgU29uaSBTb25pXCIsXCJlbWFpbFwiOlwicHJpeWFob3RzdHVmZkBnbWFpbC5jb21cIixcInBob25lXCI6XCI3Mjg0OTIyODgzXCIsXCJleHRBdXRoSWRcIjpcIjEwMTU0OTc5ODI1MTI0MzY5XCIsXCJpcFwiOlwiMTA2LjIwOC4xMzIuNVwiLFwiY291bnRyeUNvZGVcIjpcImluXCIsXCJjdXN0b21lclR5cGVcIjpcIm51XCIsXCJ0eXBlXCI6XCJtZXJnZWRcIixcImlzRW1haWxWZXJpZmllZFwiOmZhbHNlLFwiaXNQaG9uZVZlcmlmaWVkXCI6dHJ1ZSxcImRldmljZUlkXCI6XCIwOWMxZmU1NS05ZDNmLTRlNTQtOGQ1OS02NTBlZGNlMjMzZTlcIixcInZlcnNpb25cIjpcInYyXCIsXCJzdWJzY3JpcHRpb25zXCI6e1wiaW5cIjp7XCJIb3RzdGFyUHJlbWl1bVwiOntcInNob3dBZHNcIjpcIjBcIixcImV4cGlyeVwiOlwiMjAxOS0xMC0wMVQxNDozNzo0OS4wMDBaXCIsXCJzdGF0dXNcIjpcIkNcIn19fSxcImlzc3VlZEF0XCI6MTU2MjQ5MTQxMDA2NX0iLCJpc3MiOiJVTSIsImV4cCI6MTU2MjU3NzgxMH0.qxnOPa8OI6LvivBI4inLcoA-Aq7SUX0uccuNCPuI6HM\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"message\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Login Success\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"appCode\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"UMSP_700\"</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3>How its happening</h3>\n<p>IMO, when the login form is submitted, the server is not checking the <code class=\"language-text\">userType</code>. It only matches password and email irrespective of the user type.</p>\n<h3>Conclusion</h3>\n<p>Never trust frontend, always perform validations at the backend.\nIf someone from the Hotstar team is reading this, then pls don’t fire the developers.😉</p>","frontmatter":{"title":"Authentication 🛡️ (A Hotstar Case Study)","date":"July 07, 2019"}}},"pageContext":{"slug":"/authentication-a-hotstar-case-study/","previous":null,"next":{"fields":{"slug":"/react-hot-reloading-cra/"},"frontmatter":{"title":"React h🔥t reloading ft. CRA"}}}}